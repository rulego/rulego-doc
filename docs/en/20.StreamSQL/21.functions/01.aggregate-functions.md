---
title: Aggregate Functions
date: 2024-01-15 10:07:00
permalink: /pages/streamsql-aggregate-functions/
article: false
author: 
  name: StreamSQL
  link: https://github.com/rulego/streamsql
---

# StreamSQL Aggregate Functions

Aggregate functions perform calculations on a set of values and return a single value. Aggregate functions can only be used in the following expressions:
- SELECT list in SELECT statements (subqueries or outer queries)
- HAVING clause

## SUM - Sum Function
**Syntax**: `sum(col)`  
**Description**: Returns the sum of numeric values in a group. NULL values are ignored.  
**Incremental Calculation**: âœ… Supported  
**Example**:
```sql
SELECT device, sum(temperature) as total_temp 
FROM stream 
GROUP BY device, TumblingWindow('10s')
```

## AVG - Average Function
**Syntax**: `avg(col)`  
**Description**: Returns the average of numeric values in a group. NULL values are ignored.  
**Incremental Calculation**: âœ… Supported  
**Example**:
```sql
SELECT device, avg(temperature) as avg_temp 
FROM stream 
GROUP BY device, TumblingWindow('10s')
```

## COUNT - Count Function
**Syntax**: `count(*)`  
**Description**: Returns the number of rows in a group.  
**Incremental Calculation**: âœ… Supported  
**Example**:
```sql
SELECT device, count(*) as record_count 
FROM stream 
GROUP BY device, TumblingWindow('10s')
```

## MIN - Minimum Function
**Syntax**: `min(col)`  
**Description**: Returns the minimum value in a group. NULL values are ignored.  
**Incremental Calculation**: âœ… Supported  
**Example**:
```sql
SELECT device, min(temperature) as min_temp 
FROM stream 
GROUP BY device, TumblingWindow('10s')
```

## MAX - Maximum Function
**Syntax**: `max(col)`  
**Description**: Returns the maximum value in a group. NULL values are ignored.  
**Incremental Calculation**: âœ… Supported  
**Example**:
```sql
SELECT device, max(temperature) as max_temp 
FROM stream 
GROUP BY device, TumblingWindow('10s')
```

## COLLECT - Collect Function
**Syntax**: `collect(col)`  
**Description**: Collects all column values from messages in the current window into an array.  
**Incremental Calculation**: âœ… Supported  
**Example**:
```sql
SELECT device, collect(temperature) as temp_values 
FROM stream 
GROUP BY device, TumblingWindow('10s')
```

## LAST_VALUE - Last Value Function
**Syntax**: `last_value(col)`  
**Description**: Returns the value from the last row in a group.  
**Incremental Calculation**: âœ… Supported  
**Example**:
```sql
SELECT device, last_value(temperature) as last_temp 
FROM stream 
GROUP BY device, TumblingWindow('10s')
```

## MERGE_AGG - Merge Aggregate Function
**Syntax**: `merge_agg(col)`  
**Description**: Merges values in a group into a single value. For object types, merges all key-value pairs; for other types, concatenates with commas.  
**Incremental Calculation**: âœ… Supported  
**Example**:
```sql
SELECT device, merge_agg(status) as all_status 
FROM stream 
GROUP BY device, TumblingWindow('10s')
```

## DEDUPLICATE - Deduplication Function
**Syntax**: `deduplicate(col, false)`  
**Description**: Returns deduplicated results for the current group, typically used in windows. The second parameter specifies whether to return all results.  
**Incremental Calculation**: âœ… Supported  
**Example**:
```sql
SELECT device, deduplicate(temperature, true) as unique_temps 
FROM stream 
GROUP BY device, TumblingWindow('10s')
```

## STDDEV - Standard Deviation Function
**Syntax**: `stddev(col)`  
**Description**: Returns the population standard deviation of all values in a group. NULL values are ignored.  
**Incremental Calculation**: âœ… Supported (optimized using Welford's algorithm)  
**Example**:
```sql
SELECT device, stddev(temperature) as temp_stddev 
FROM stream 
GROUP BY device, TumblingWindow('10s')
```

## STDDEVS - Sample Standard Deviation Function
**Syntax**: `stddevs(col)`  
**Description**: Returns the sample standard deviation of all values in a group. NULL values are ignored.  
**Incremental Calculation**: âœ… Supported (optimized using Welford's algorithm)  
**Example**:
```sql
SELECT device, stddevs(temperature) as temp_sample_stddev 
FROM stream 
GROUP BY device, TumblingWindow('10s')
```

## VAR - Variance Function
**Syntax**: `var(col)`  
**Description**: Returns the population variance of all values in a group. NULL values are ignored.  
**Incremental Calculation**: âœ… Supported (optimized using Welford's algorithm)  
**Example**:
```sql
SELECT device, var(temperature) as temp_variance 
FROM stream 
GROUP BY device, TumblingWindow('10s')
```

## VARS - Sample Variance Function
**Syntax**: `vars(col)`  
**Description**: Returns the sample variance of all values in a group. NULL values are ignored.  
**Incremental Calculation**: âœ… Supported (optimized using Welford's algorithm)  
**Example**:
```sql
SELECT device, vars(temperature) as temp_sample_variance 
FROM stream 
GROUP BY device, TumblingWindow('10s')
```

## MEDIAN - Median Function
**Syntax**: `median(col)`  
**Description**: Returns the median of all values in a group. NULL values are ignored.  
**Incremental Calculation**: âœ… Supported  
**Example**:
```sql
SELECT device, median(temperature) as temp_median 
FROM stream 
GROUP BY device, TumblingWindow('10s')
```

## PERCENTILE - Percentile Function
**Syntax**: `percentile(col, 0.5)`  
**Description**: Returns the specified percentile of all values in a group. The second parameter specifies the percentile value, ranging from 0.0 to 1.0.  
**Incremental Calculation**: âœ… Supported  
**Example**:
```sql
SELECT device, percentile(temperature, 0.95) as temp_p95 
FROM stream 
GROUP BY device, TumblingWindow('10s')
```

## ðŸ“š Related Documentation

- [Analytical Functions](/en/pages/streamsql-analytical-functions/) - Learn detailed usage of analytical functions
- [Window Functions](/en/pages/streamsql-window-functions/) - Learn detailed usage of window functions
- [SQL Reference](/en/pages/streamsql-sql/) - View complete SQL syntax reference