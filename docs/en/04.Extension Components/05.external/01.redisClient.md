---
title: redisClient
article: false
author: 
  name: rulego
  link: https://github.com/rulego/rulego
date: 2023-09-13 21:35:33
permalink: /pages/redis-client/
---

`x/redisClient` component: redis client. Can execute redis commands.

## Configuration

This component allows the reuse of shared connection clients through the `server` field. See [Component Connection Reuse](/en/pages/baa05d/) for reference.

| Field                                  | Type   | Description                                                                                                      | Default value |
|----------------------------------------|--------|------------------------------------------------------------------------------------------------------------------|---------------|
| server                                 | string | Redis server address, format: host:port                                                                          | None          |
| password                               | string | Redis password                                                                                                   | None          |
| poolSize                               | int    | Connection pool size                                                                                             | 0             |
| db                                     | int    | Redis database index                                                                                             | 0             |
| cmd                                    | string | Redis command, supports command with parameters format (e.g., "SET key value") and ${} variable replacement      | None          |
| paramsExpr <Badge text="Deprecated" /> | string | Dynamic parameter expression (deprecated, use params field instead)                                              | None          |
| params                                 | array  | Command parameters, supports ${} variable replacement and [Component Configuration Variables](/en/pages/baa05c/) | None          |

## Configuration Details

### cmd Field
The `cmd` field supports two formats:
1. **Command only**: Such as "SET", "GET", "HSET", etc., with parameters provided via the `params` field
2. **Command with parameters**: Such as "SET key value", "HSET myhash field1 value1", etc., where command and parameters are provided together

### params Field
The `params` field supports:
- **Static parameters**: Direct parameter values, such as `["key1", "value1"]`
- **Dynamic parameters**: Using `${}` syntax for variable replacement, such as `["${metadata.key}", "${data}"]`
- **Component configuration variables**: Supports all [Component Configuration Variables](/en/pages/baa05c/) syntax


## Relation Type

- ***Success:*** Execution successful, send the message to the `Success` chain
- ***Failure:*** Execution failed, send the message to the `Failure` chain


## Execution result

The execution result replaces msg.Data and passes to the next node.

## Configuration Examples

### Example 1: Using command only with params
```json
{
  "id": "s5",
  "type": "x/redisClient",
  "name": "Save to redis",
  "debugMode": true,
  "configuration": {
    "server": "192.168.1.1:6379",
    "cmd": "SET",
    "params": ["${metadata.key}", "${metadata.value}"],
    "poolSize": 10
  }
}
```

### Example 2: Using command with parameters format
```json
{
  "id": "s6",
  "type": "x/redisClient",
  "name": "Set hash field",
  "debugMode": true,
  "configuration": {
    "server": "192.168.1.1:6379",
    "cmd": "HSET ${msg.hashKey} ${msg.field}",
    "params": ["${data}"],
    "poolSize": 10
  }
}
```

### Example 3: Complete command (without params)
```json
{
  "id": "s7",
  "type": "x/redisClient",
  "name": "Complete SET command",
  "debugMode": true,
  "configuration": {
    "server": "192.168.1.1:6379",
    "cmd": "SET ${msg.key} ${msg.value}",
    "poolSize": 10
  }
}
```

## Application example

Application example reference: [redisClient](https://github.com/rulego/rulego-components/blob/main/examples/redis/call_redis_client.go)

```json
{
  "ruleChain": {
    "id":"chain_msg_type_switch",
    "name": "Test rule chain-msgTypeSwitch",
    "root": false,
    "debugMode": false
  },
  "metadata": {
    "nodes": [
      {
        "id": "s1",
        "type": "msgTypeSwitch",
        "name": "Filter",
        "debugMode": true
      },
      {
        "id": "s2",
        "type": "log",
        "name": "Log 1",
        "debugMode": true,
        "configuration": {
          "jsScript": "return msgType+':s2--'+JSON.stringify(msg);"
        }
      },
      {
        "id": "s3",
        "type": "log",
        "name": "Log 2",
        "debugMode": true,
        "configuration": {
          "jsScript": "return msgType+':s3--'+JSON.stringify(msg);"
        }
      },
      {
        "id": "s5",
        "type": "x/redisClient",
        "name": "Save to redis",
        "debugMode": true,
        "configuration": {
          "cmd": "SET",
          "params": ["${msg.key1}", "${msg.value1}"],
          "poolSize": 10,
          "Server": "192.168.1.1:6379"
        }
      },
	{
        "id": "s6",
        "type": "x/redisClient",
        "name": "Save to redis",
        "debugMode": true,
        "configuration": {
          "cmd": "SET",
          "params": ["${msg.key2}", "${msg.value2}"],
          "poolSize": 10,
          "Server": "192.168.1.1:6379"
        }
      }
    ],
    "connections": [
      {
        "fromId": "s1",
        "toId": "s2",
        "type": "TEST_MSG_TYPE1"
      },
      {
        "fromId": "s1",
        "toId": "s3",
        "type": "TEST_MSG_TYPE2"
      },
      {
        "fromId": "s3",
        "toId": "s5",
        "type": "Success"
      },
  		{
        "fromId": "s2",
        "toId": "s6",
        "type": "Success"
      }
    ]
  }
}
```